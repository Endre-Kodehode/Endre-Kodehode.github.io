const canvas = document.getElementById("canvas1");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
let particleArray = [];
let adjustX = canvas.width / 2 - 200;
let adjustY = canvas.height / 2 - 100;
const mouse = {
  x: 0,
  y: 0,
  radius: 50,
};

window.addEventListener("mousemove", function (e) {
  mouse.x = e.x;
  mouse.y = e.y;
});

const myImage = new Image();
myImage.src =
  "data:image/png;base64,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YWIwLTg0MDctZDgxNGFjOTQ3OWE4IgogICB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjYzNzMzYjhiLTEyYzMtNGYzZi04NTE5LTUzZjUzYzA5ZTUyMyIKICAgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjk0YzFjYmI0LTAyNDctNGY3Yi04NjYwLWI3ZjQxZTM3Njg0MSIKICAgZGM6Rm9ybWF0PSJpbWFnZS9wbmciCiAgIEdJTVA6QVBJPSIyLjAiCiAgIEdJTVA6UGxhdGZvcm09IldpbmRvd3MiCiAgIEdJTVA6VGltZVN0YW1wPSIxNjM3OTE2NzEwNDc3MDIzIgogICBHSU1QOlZlcnNpb249IjIuMTAuMjgiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiCiAgIHhtcDpDcmVhdG9yVG9vbD0iR0lNUCAyLjEwIj4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6M2EzMmQ3NmQtMWZlYS00MDkwLWJlOWItMjE0MWJkODViNzc1IgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKFdpbmRvd3MpIgogICAgICBzdEV2dDp3aGVuPSIyMDIxLTExLTI2VDA5OjUxOjUwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Ppi1cl4AAABmUExURQAAAP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////5WfaagAAAABdFJOUwBA5thmAAAAAWJLR0QAiAUdSAAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+ULGggzMvCGw3MAAATbSURBVHja7d1ZktswDEVRYv+bTmWoSpxucQAeSEi6+Oy2bALHlEhaQ2uesF/RiBphf4NilOJApJwHItU8ECkHgkgxD0AAIXoeiABCAAIIkQaC2TEQmw0qmT7steWgmMVAMMlcOjFDpArIVAehcNtERh5UbK8I85NaJN0DC7GZpL8bI0rtxIgiHpSjEgfVgINgX3Wf6TpRxYOS4EEwC7yHBwXBg7gGoR5MPQg88CDwuDsIxcCDwAMPwgNCLfAg8LgLCKWggxB4sMMi8MCDAAQPAg9ACDyILyBUgg5C0EFuA0Ih6CAEHYQOQtBBACHkINSBDkLQQQAhfCCUARCiA0IVACF6IhShFgg1KCZCCQiCIIj9E0r9gGDtRkS1V0b33uVq+lPW2rR2a0FPqpEaBXOx8yCuh4vNb7GcZ6RGilzsLIjjARdrGyxmGXnghiiX4RaJIK7nv6y9XlBS797H3AXob5AH4ns4Uh5I5GFNwlxG2aSBOB9X9c8LJl6+ABJ5fFYwl9kNYseYuVJ9vmS5xKOXz4N426PLZXjduWWCXH24rZZYBOJujzKX/jmJlgnSaerM10QO4m+PMpd+ezNBug21ie+JTbZz9Zi83h5pLm38Xrkgbf2/V91cArL5v9/87/rllggyuxPYBSJojyaXMUjKTD00wU4EcYmJtz0JIto4DhJpjzaX2AeVAmmAuEFiRdIPeyPt0eYCSDkQuz2IYC2rIIhnIBQFmdt88LaSxcVIe4S5ZHeQZBDh8nvk13kpiNkRkODpCfpfDAPtScgla56+FSS0y7JyIO0BIIGJYTmQ9gwQewpIezvItoN66HhYfpTVZoYmNxn2yk+fyQBxzG4tBGIBEJOACBpZYemkxRbHq61lPQKkAaIA0S1Zp+FPtFmfy36Qdl+Q9mgQ4U+mEhBXe/S5HABRnxgQ3ktHBp3yXACZPiHVkrY9DyI+lyn+M8LUdN/k224FcWfhWNSJ/4xQ5VTSwHEuRno9P3Us6ggOmxPtsbYjl1MgVyfre1bZJL/ruNvTLq/0lK4Yuq9CXR24LF/lol9cjLVHmUsGyO9Nwml4tpp9tbY9glwSQQQXobqvFG1RkGMXfW4EcWah20bT+3xfRumaug9kPRPZ9ZWi949cyu/OZenNcz2+buX7IioLHLmxgi+XNBB/LrGr+xO+8ZEh/3IueSBbniidvEvcGRtAiOyvIaUoBoIIIAQgHEQIugggBCCvAEEEEIJx1q1IqEQxEQpRpk8gUuVA/nkbVkpz3OO/m4lQnOMenyJU57zHHwVAynggAgjR9TAO68VAjOk6IMQsCCKAANIFQaQaCCKF5iGAVAEpet74K0W++TNlAgQRu7wBNiInRS7+TpnOkFxLUaX9Jt2+Q4mq7c4oBiIEIogQskEY8WwRyEuJ0AtL1YuVs0DN0j0QOS1S+cY9tyAB5Nkite9t9UKRKMi7BfUigRuCMljO6CSKO+ay3xIWwQPCESdRJHyPaw7tWhLXfezhyBMJ3dEdiQSStUe9wzEo5B4QJo87SUbFNjj2kvSrDYejnGIRzTSeUImgUUsEjoqHIzh0ZU2bLVJdbyXTB8LE3hk8HDmHZ2efQiNzCLu2js6RY4OIXT/FdhxUM1FkOahkJRGqWImEAlYyoXSFTKhZHRRKVWswTPyMH2PpID+G/nCuAAAAAElFTkSuQmCC";
console.log(myImage);
ctx.drawImage(myImage, 0, 0, 400, 202);

const textCoordinates = ctx.getImageData(0, 0, 400, 202);

class Particle {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.size = 1;
    this.baseX = this.x;
    this.baseY = this.y;
    this.density = Math.random() * 30 + 1;
  }
  draw() {
    ctx.fillStyle = "white";
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.closePath();
    ctx.fill();
  }
  update() {
    let dx = mouse.x - this.x;
    let dy = mouse.y - this.y;
    let distance = Math.sqrt(dx * dx + dy * dy);
    let forceDirectionX = dx / distance;
    let forceDirectionY = dy / distance;
    let maxDistance = mouse.radius;
    let force = (maxDistance - distance) / maxDistance;
    let directionX = forceDirectionX * force * this.density;
    let directionY = forceDirectionY * force * this.density;
    if (distance < mouse.radius) {
      this.x -= directionX;
      this.y -= directionY;
    } else {
      if (this.x !== this.baseX) {
        let dx = this.x - this.baseX;
        this.x -= dx / 10;
      }
      if (this.y !== this.baseY) {
        let dy = this.y - this.baseY;
        this.y -= dy / 10;
      }
    }
  }
}

function init() {
  particleArray = [];
  for (let y = 0, y2 = textCoordinates.height; y < y2; y++) {
    for (let x = 0, x2 = textCoordinates.width; x < x2; x++) {
      if (
        textCoordinates.data[y * 4 * textCoordinates.width + x * 4 + 3] > 128
      ) {
        let positionX = x + adjustX;
        let positionY = y + adjustY;
        particleArray.push(new Particle(positionX, positionY));
      }
    }
  }
}
init();

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  for (let i = 0; i < particleArray.length; i++) {
    particleArray[i].draw();
    particleArray[i].update();
  }
  requestAnimationFrame(animate);
}
animate();
